<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="estilos.css">
    <title>Lector de noticias</title>
</head>
<body>

    <h1 class="titulo">Noticias desde GNews</h1>
    
    <div class="boton_refresh">
        <button id="btnRefrescar">Refrescar</button>
    </div>
    
    
    <p id="error"></p>

    <div class="seccion" id="contenedor"></div>

    <script>
        const API_KEY = "25146926fbebf02e4dcee3149a34e0d4";

        window.onload = obtenerNoticias;

        document.getElementById("btnRefrescar").addEventListener("click", obtenerNoticias);

        function obtenerNoticias() {
            const url = `https://gnews.io/api/v4/top-headlines?lang=es&country=mx&max=5&apikey=${API_KEY}`;

            document.getElementById("error").innerText = "";
            document.getElementById("contenedor").innerHTML = "Cargando noticias...";

            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Error al conectar con la API");
                    }
                    return response.json();
                })
                .then(data => {
                    mostrarNoticias(data);
                })
                .catch(error => {
                    mostrarError("No se pudieron obtener las noticias. Intenta más tarde.");
                    console.log("Error:", error);
                });
        }

        function mostrarNoticias(data) {
            const contenedor = document.getElementById("contenedor");
            contenedor.innerHTML = "";

            if (!data.articles || data.articles.length === 0) {
                mostrarError("No hay noticias disponibles en este momento.");
                return;
            }

            data.articles.forEach(noticia => {
                const div = document.createElement("div");
                div.classList.add("noticia");

                div.innerHTML = `
                    <h2>${noticia.title}</h2>
                    ${noticia.image ? `<img src="${noticia.image}">` : ""}
                    <p>${noticia.description || "Sin descripción disponible."}</p>
                    <a href="${noticia.url}" target="_blank">Leer más</a>
                `;

                contenedor.appendChild(div);
            });
        }

        function mostrarError(mensaje) {
            document.getElementById("contenedor").innerHTML = "";
            document.getElementById("error").innerText = mensaje;
        }
    </script>

</body>

</html>